define(['jquery','Magento_Ui/js/modal/modal','mage/translate'],function($){"use strict";$.widget('seasalt.thankYouMessage',{options:{modalForm:'#thank-for-subscribe',},_create:function(){this.searchForm=$('.newsletter-validate-detail, #newsletter-validate-detail, .newsletter-form');this.options.modalOption=this.getModalOptions();this._bind();},getModalOptions:function(){var options={type:'popup',innerScroll:true,modalClass:"thanks-modal",title:'',buttons:[]};return options;},setErrorMessage(message){var recaptchaErrorDiv=$("<div>",{id:"newsletter_block_recaptcha-error","class":"mage-error"});recaptchaErrorDiv.html(message);$('.seasalt-friends-input').append(recaptchaErrorDiv);},_bind:function(){var selfWidget=this,modalOption=this.options.modalOption,modalForm=this.options.modalForm,popupNewsletter=$(".popup-newsletter");$(modalForm).modal(modalOption);$('input[id="newsletter_block"]').on('change',function(){var errMessage=$('#newsletter_block_recaptcha-error');if(errMessage.length>0){errMessage.remove();}});this.searchForm.on('submit',function(e){var self=this,isValid=false;if(!$(this).valid()){return false;}
$('body').trigger('processStart');setTimeout(function(){if($(self).find('input#newsletter_block, input#newsletter').hasClass('valid')){$('form.newsletter-validate-detail').find('.newsletter .control').removeClass('error')
isValid=true;}
if(isValid){e.preventDefault();var action=$(self).attr('action');$.ajax({url:action,method:'POST',data:$(self).serialize(),success:function(response){$('body').trigger('processStop');if(response!==true){var infoMessage=response.message;if(!infoMessage){infoMessage=$.mage.__('Sorry, something went wrong. Please check your email address and try again.');}
selfWidget.setErrorMessage(infoMessage);}
if(popupNewsletter.closest('.newsletter-modal').hasClass('_show')||response!==true){popupNewsletter.modal('closeModal');return;}
$(modalForm).modal('openModal');$('input#newsletter_block').val('');$(".product-sticky").removeClass('active');$(".product-sticky").removeAttr('style');},error:function(){$('body').trigger('processStop');selfWidget.setErrorMessage($.mage.__('Sorry, something went wrong. Please check your email address and try again.'));$('.seasalt-friends-input').append(recaptchaErrorDiv);if(popupNewsletter.closest('.newsletter-modal').hasClass('_show')){popupNewsletter.modal('closeModal');}
$(".product-sticky").removeClass('active');$(".product-sticky").removeAttr('style');}});}},1000);return false;});}});return $.seasalt.thankYouMessage;});