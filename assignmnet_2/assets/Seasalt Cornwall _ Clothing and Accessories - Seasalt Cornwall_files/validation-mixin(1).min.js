define(['jquery','ko'],function($,ko){'use strict';let passwordErrorMessages=ko.observableArray([{name:"character-limit",status:false,message:"At least 8 characters"},{name:"upper-lower-case-characters",status:false,message:"Both upper and lowercase letters"},{name:"contains-number",status:false,message:"At least one number"},{name:"no-special-characters",status:false,message:"At least one special character"},{name:"no-brand-name",status:false,message:"Should not contain the word Seasalt or Cornwall."},]);let hasTypedPassword=false;function updatePasswordErrorMessageStatus(name,status,visible=true){const message=passwordErrorMessages().find(obj=>obj.name===name);message.status=status;message.visible=visible;passwordErrorMessages(passwordErrorMessages());}
function generatePasswordErrorMessage(passwordInputElement){let errorMessageOutput='';let errorMessageClasses=$(passwordInputElement).val().length<=0?'custom-password-errors--empty':'';errorMessageOutput+=`<div class="custom-password-errors ${errorMessageClasses}">`;if($(passwordInputElement).val().length>0){hasTypedPassword=true;}
if(hasTypedPassword===true){$(passwordInputElement).parent('.control').addClass('error');errorMessageOutput+=`<div class="custom-password-errors__intro">${$.mage.__('Sorry, your chosen password does not meet the requirements.')}</div>`;}
errorMessageOutput+=`<div class="custom-password-errors__heading">${$.mage.__('Your password should include:')}</div>`;passwordErrorMessages().forEach((errorMessage)=>{if(errorMessage.visible){errorMessageOutput+=`<div class="custom-password-errors__message" data-status="${errorMessage.status}">${$.mage.__(errorMessage.message)}</div>`}});errorMessageOutput+='</div>';return errorMessageOutput;}
return function(){$('input[type="password"]').each(function(i,el){$(el).on('keyup click focus',function(){$.validator.validateElement(this);})});$('[data-validate], input.required-entry').each(function(i,el){el.addEventListener('blur',function(){$.validator.validateElement(el);if(el.id!=='zip'){if($.validator.validateElement(el)){$(el).parent('.control').addClass('valid');$(el).parent('.control').removeClass('error');}else{$(el).parent('.control').addClass('error');$(el).parent('.control').removeClass('valid');}}
if(el.type==='password'&&el.value.length===0){$(el).parent('.control').removeClass('error');$(el).parent('.control').removeClass('valid');}});});$.validator.addMethod('email-validation-lowercase',function(value){return(!value||/^[_a-z0-9]+(\.[_a-z0-9]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,6})$/.test(value));},$.mage.__('Please enter a valid email address. Use lowercase only.'));$.validator.addMethod('swatch-option-validation',function(value,element){var isValid=true;if($(element).val().length===0){isValid=false;$(element).addClass('mage-error');}
return isValid;},function(value,element){var labelText=$(element).parent().find('.swatch-attribute-label').text(),message;message=$.mage.__('Please select '+'<span>'+labelText+'</span>');return message;});$.validator.addMethod('checkout_telephone_validation',function(value){return!value||value.match(/^(\+?[\d\s]+)$/);},$.mage.__('Please specify a valid phone number'));$.validator.addMethod('emoji-validation',function(value,element){if(/(\u00a9|\u00ae|[\u2000-\u3300]|\ud83c[\ud000-\udfff]|\ud83d[\ud000-\udfff]|\ud83e[\ud000-\udfff])/g.test(value)){return false;}
return true;},$.mage.__("Value must not include special characters"));$.validator.addMethod('special-chars',function(value,element){if(/[\'^£$%&*()}{@#~><>|=_+¬-]/.test(value)){return false;}
return true;},$.mage.__("Value must not include special characters"));$.validator.addMethod('special-chars-giftcard-name',function(value){if(/[\'^£$%&*()}{@#~><>|=_+¬-]/.test(value)){return false;}
return true;},$.mage.__("Sorry, names cannot contain special characters"));$.validator.addMethod('required-with-input',function(value){return!!value.trim();},function(value,element){return $.mage.__('Please enter '+element.dataset.validatorLabel+'.');});$.validator.addMethod('line-breaks-special-chars',function(value,element){if(/[\'\r\n^£$%&*()}{@#~><>|=_+¬-]/.test(value)){return false;}
return true;},$.mage.__("Sorry, messages cannot contain line breaks or special characters"));$.validator.addMethod('accents-validation',function(value,element){var valid=true;var accents='ÀÁÂÃÄÅàáâãäåÒÓÔÕÕÖØòóôõöøÈÉÊËèéêëðÇçÐÌÍÎÏìíîïÙÚÛÜùúûüÑñŠšŸÿýŽž';if(Array.from(value).forEach(function(char){var includes=accents.includes(char);if(valid&&includes){valid=false;}}))
if(valid){$(element).removeClass('mage-error');}
return valid;},$.mage.__('String must not include special characters'));$.validator.addMethod('qas-address',function(value,element){var form=$(element).closest('form');var address=form.find('.fieldset.address');if(address.css('display')==='none'){form.find('.fieldset.address').show();return false;}
$(element).removeClass('mage-error');$(element).siblings('.mage-error').remove();return true;},$.mage.__('Please specify a valid address'));$.validator.addMethod('validate-email',function(value){var values=value.split('@');var len=values.length;if(len>2||len<2){return false;}
if(values[0]){if(values[0].length>50){return false;}
if(values[0].indexOf('}')!==-1){return false;}
if(values[0].indexOf('{')!==-1){return false;}}
if(values[1]){if(values[1].length>64){return false;}}
if((/(www\.|https\:\/\/|http\:\/\/)/i.test(value))){return false;}
return $.mage.isEmptyNoTrim(value)||/^([a-z0-9,!\#\$%&'\*\+\/=\?\^_`\{\|\}~-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z0-9,!\#\$%&'\*\+\/=\?\^_`\{\|\}~-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*@([a-z0-9-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z0-9-]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*\.(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]){2,})$/i.test(value);},$.mage.__('Please enter a valid email address (Ex: johndoe@domain.com).'));$.validator.addMethod('validate-telephone',function(value){return value.length>=9&&value.match(/^(\+?[\d\s]+)$/);},$.mage.__("Please specify a valid phone number"));$.validator.addMethod('validate-search-field-seasalt-shop-required',function(value){return!(value===''||value==null||value.length===0||/^\s+$/.test(value));},$.mage.__('Enter your nearest town then click ‘Search’ to find your closest Seasalt shop'));$.validator.addMethod('validate-alpha-dashes-spaces',function(value){return!value.length||/^[a-zA-Z\-\.\s]+$/i.test(value);},$.mage.__('Please use only letters (a-z or A-Z), dots (.), dashes(-) and spaces on this field.'));$.validator.addMethod('validate-alphanum-dots-commas-dashes-spaces',function(value){return!value.length||/^[a-zA-Z0-9\-\.\,\s]+$/i.test(value);},$.mage.__('Please use only letters (a-z or A-Z), numbers (0-9), dots (.), commas(,), '+'dashes(-) and spaces on this field.'));$.validator.addMethod('validate-atleast-one-letter',function(value){return!value.length||/[a-zA-Z]/.test(value);},$.mage.__('The field must contain at least one letter.'));$.validator.addMethod('validate-no-link',function(value){return!value.length||!(/(www\.|https\:\/\/|http\:\/\/)/i.test(value));},$.mage.__('The field must contain a valid word'));$.validator.addMethod('validate-custom-password',function(value,elm){let passwordMinLength=$(elm).data('password-min-length');let pass=$.trim(value);let result=pass.length>=passwordMinLength;if(pass.length<passwordMinLength){updatePasswordErrorMessageStatus('character-limit',false)
result=false;}else{updatePasswordErrorMessageStatus('character-limit',true)}
if(!pass.match(/[^a-zA-Z0-9]+/)){updatePasswordErrorMessageStatus('no-special-characters',false)
result=false;}else{updatePasswordErrorMessageStatus('no-special-characters',true)}
if(!pass.match(/^(?=.*[a-z])(?=.*[A-Z]).+$/)){updatePasswordErrorMessageStatus('upper-lower-case-characters',false)
result=false;}else{updatePasswordErrorMessageStatus('upper-lower-case-characters',true)}
if(!pass.match(/\d+/)){updatePasswordErrorMessageStatus('contains-number',false);result=false;}else{updatePasswordErrorMessageStatus('contains-number',true);}
if(pass.match(/(Seasalt|Cornwall)/i)){updatePasswordErrorMessageStatus('no-brand-name',false,true)
result=false;}else{updatePasswordErrorMessageStatus('no-brand-name',true,false)}
return result;},function(v,element){return generatePasswordErrorMessage(element);})}});