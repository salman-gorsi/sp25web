define(['jquery','uiComponent','Magento_Customer/js/customer-data','mage/cookies'],function($,Component,customerData){'use strict';return Component.extend({defaults:{customerDataExists:false},initialize:function(){const self=this;this._super();self.triggerDataLayer();},triggerDataLayer:function(){const self=this;const customer=customerData.get('customer')();const csr=customerData.get('csr_panel')();if(customer.logged_in&&!this.customerDataExists){let dataLayerData={...customer,'csr_logged_in':(csr.csr_logged_in)};self.customerDataLayer(dataLayerData);this.customerDataExists=true;}else if(!customer.logged_in&&!this.customerDataExists){self.guestDataLayer();this.customerDataExists=true;}},customerDataLayer:function(data){const dataLayerObject={"event":"Customer Data","customer_id":data.customer_id,"loggedIn":data.logged_in,"email":data.email,"email_hash":data.email_hash,"custServiceAgent":(data.csr_logged_in?data.csr_logged_in:null)};this.addToDatalayer(dataLayerObject);},guestDataLayer:function(){const guestData=$.parseJSON($.mage.cookies.get('guest_data'));const dataLayerObject={"event":"Customer Data","loggedIn":false,"email":(guestData&&guestData.email)?guestData.email:null,"email_hash":(guestData&&guestData.email_hash)?guestData.email_hash:null};this.addToDatalayer(dataLayerObject);},addToDatalayer:function(object){window.dataLayer=window.dataLayer||[];window.dataLayer.push(object);}});});