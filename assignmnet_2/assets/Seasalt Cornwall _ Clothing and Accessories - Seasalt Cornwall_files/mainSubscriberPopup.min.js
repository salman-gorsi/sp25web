define(['jquery','Magento_Ui/js/modal/modal','jquery-ui-modules/widget','mage/cookies',"domReady!"],function($,modal){'use strict';$.widget('seasalt.mainSubscriberPopup',modal,{_init:function(){var $widget=this,delay=this.options.delay,time=this.getTime(delay),visitsMax=this.options.visits,cookie='newsletter-popup',options={type:'popup',innerScroll:true,title:$.mage.__(this.options.title),modalClass:"newsletter-modal",buttons:''};if(!this.isPopupShow(cookie)){if(visitsMax>0){var visit=$.mage.cookies.get('popup-visits');if(visitsMax>visit){var visitNext=Number(visit)+Number(1);$.mage.cookies.set('popup-visits',visitNext,{lifetime:360000});}else{$widget.openModal(options,cookie);}}
if(delay>0){this.logTime(time,function(){$widget.openModal(options,cookie);});}
if(visitsMax==0&&delay==0){$widget.openModal(options,cookie);}}},openModal:function(options,cookie){var html=this.element,popup=modal(options,html),prevActiveElement=document.activeElement;html.modal('openModal');setTimeout(function(){document.querySelector('.newsletter-modal').focus();},1000);this.setCookie(cookie);html.on('modalclosed',this.setPreviousActiveElement(prevActiveElement));},setPreviousActiveElement:function(prevActiveElement){prevActiveElement.focus();},getTime:function(delay){var cookie=$.mage.cookies.get('popup-timing');if(cookie>0&&this.isPopupShow()!==true){return cookie}else{return delay}},logTime:function(i,callback){callback=callback||function(){};var int=setInterval(function(){if($.mage.cookies.get('newsletter-popup')){clearInterval(int);$.mage.cookies.set('popup-timing',0);}else{$.mage.cookies.set('popup-timing',i);i--||(clearInterval(int),callback());}},1000);},setCookie:function(cookie){$.mage.cookies.set(cookie,true,{lifetime:360000});},isPopupShow:function(cookie){return $.mage.cookies.get(cookie);},});return $.seasalt.mainSubscriberPopup;});